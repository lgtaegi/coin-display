<!--
coin-display
Version: 0.1
Author: lgtaegi
Notes:
- Clean new start
- BTC price display
- Small current time shown below
- Toggle button: Price ↔ Time
- Timezone: Salt Lake City, UT (America/Denver)
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>coin-display</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: #000;
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      text-align: center;
    }

    .main {
      font-size: clamp(3rem, 10vw, 8rem);
      font-weight: 700;
      letter-spacing: 0.05em;
    }

    .sub-time {
      margin-top: 10px;
      font-size: 1rem;
      opacity: 0.7;
    }

    .controls {
      margin-top: 20px;
    }

    button {
      background: #111;
      color: #fff;
      border: 1px solid #333;
      padding: 6px 14px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    button:hover {
      background: #222;
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="main" id="mainDisplay">--</div>
    <div class="sub-time" id="subTime">--</div>

    <div class="controls">
      <button id="toggleBtn">Show Time</button>
    </div>
  </div>

  <script>
    const mainDisplay = document.getElementById("mainDisplay");
    const subTime = document.getElementById("subTime");
    const toggleBtn = document.getElementById("toggleBtn");

    const API_URL = "https://api.coinbase.com/v2/prices/spot?currency=USD";
    const TIMEZONE = "America/Denver";

    let mode = "price"; // price | time
    let lastPrice = "--";

    function getLocalTime() {
      return new Intl.DateTimeFormat("en-US", {
        timeZone: TIMEZONE,
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: true
      }).format(new Date());
    }

    async function fetchPrice() {
      try {
        const res = await fetch(API_URL);
        const data = await res.json();
        lastPrice = `$${Math.round(Number(data.data.amount)).toLocaleString()}`;
        if (mode === "price") {
          mainDisplay.textContent = lastPrice;
        }
      } catch {
        if (mode === "price") {
          mainDisplay.textContent = "ERROR";
        }
      }
    }

    function updateTime() {
      const time = getLocalTime();
      subTime.textContent = `Salt Lake City · ${time}`;

      if (mode === "time") {
        mainDisplay.textContent = time;
      }
    }

    toggleBtn.addEventListener("click", () => {
      if (mode === "price") {
        mode = "time";
        mainDisplay.textContent = getLocalTime();
        toggleBtn.textContent = "Show Price";
      } else {
        mode = "price";
        mainDisplay.textContent = lastPrice;
        toggleBtn.textContent = "Show Time";
      }
    });

    // initial load
    fetchPrice();
    updateTime();

    setInterval(fetchPrice, 10000); // price update
    setInterval(updateTime, 1000);  // time update
  </script>

</body>
</html>
