<!--
Project: BTC Core Display
Version: 1.05
Date: 2026-02-09
Author: lgtaegi

Updates:
- Removed comma separators from price display
- Toggle button repositioned to top-center of main display
- Increased glitch frequency and variation
- Added electromagnetic pulse flash inside display
-->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BTC Core Wire Display</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ================= RESET ================= */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  width: 100%;
  height: 100%;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  font-family: monospace;
}

/* ================= MACHINE ================= */
.machine {
  position: relative;
  width: min(92vw, 900px);
  aspect-ratio: 1 / 1;
  background: url("machine-bg.png") center / contain no-repeat;
}

/* ================= MAIN SCREEN ================= */
.screen {
  position: absolute;
  left: 50%;
  top: 49%;
  transform: translate(-50%, -44%);
  width: 70%;
  height: 22%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ================= ELECTRIC BACKGROUND ================= */
.electric {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    repeating-linear-gradient(
      90deg,
      rgba(0,255,255,0.12) 0px,
      rgba(0,255,255,0.12) 1px,
      transparent 1px,
      transparent 12px
    ),
    repeating-linear-gradient(
      0deg,
      rgba(0,200,255,0.10) 0px,
      rgba(0,200,255,0.10) 1px,
      transparent 1px,
      transparent 18px
    );
  animation: electricMove 14s linear infinite;
  opacity: 0.4;
}

/* electromagnetic pulse */
.electric::after {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(
    circle at center,
    rgba(0,255,255,0.25),
    transparent 55%
  );
  opacity: 0;
  animation: pulse 5s ease-in-out infinite;
}

@keyframes electricMove {
  to {
    background-position: 260px 130px, -130px 260px;
  }
}

@keyframes pulse {
  0%, 90% { opacity: 0; }
  92%     { opacity: 0.35; }
  100%    { opacity: 0; }
}

/* ================= DISPLAY ================= */
.display {
  width: 100%;
  height: 70%;
  position: relative;
}

/* ================= SVG ================= */
svg {
  width: 100%;
  height: 100%;
}

/* ================= WIREFRAME TEXT ================= */
.wire {
  fill: none;
  stroke: #9ffcff;
  stroke-width: 2.2;
  stroke-linejoin: round;
  stroke-linecap: round;
  filter: drop-shadow(0 0 6px rgba(0,255,255,0.7));
}

.wire.alt {
  stroke: rgba(120,255,255,0.65);
  stroke-width: 1.2;
  stroke-dasharray: 6 4;
}

.wire.inner {
  stroke: rgba(0,220,255,0.55);
  stroke-width: 0.8;
  stroke-dasharray: 2 6;
}

/* ===== TIME MODE ===== */
.time-mode svg text {
  font-size: 100px;
}

/* ================= GLITCH ================= */
.glitch svg {
  animation: glitchShift 0.14s linear infinite;
}

.glitch .wire.alt {
  opacity: 0.25;
}

.glitch .wire.inner {
  opacity: 0.15;
}

@keyframes glitchShift {
  0%   { transform: translate(0, 0); }
  25%  { transform: translate(-4px, 1px); }
  50%  { transform: translate(4px, -1px); }
  75%  { transform: translate(-2px, 0); }
  100% { transform: translate(0, 0); }
}

/* ================= TOGGLE BUTTON ================= */
.toggle {
  position: absolute;
  top: -26%;
  left: 50%;
  transform: translateX(-50%);

  width: 36px;
  height: 36px;
  border-radius: 50%;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 1rem;
  color: rgba(200,250,255,0.95);

  border: 1px solid rgba(120,220,255,0.7);
  background: radial-gradient(
    circle at center,
    rgba(0,255,255,0.2),
    rgba(0,120,255,0.05)
  );

  cursor: pointer;
  user-select: none;

  box-shadow:
    0 0 10px rgba(0,255,255,0.7),
    inset 0 0 6px rgba(0,255,255,0.45);
}

.toggle:hover {
  box-shadow:
    0 0 14px rgba(0,255,255,1),
    inset 0 0 8px rgba(0,255,255,0.7);
}
</style>
</head>

<body>

<div class="machine">
  <div class="screen">
    <div class="electric"></div>

    <div class="display" id="display">
      <svg viewBox="0 0 1000 200" preserveAspectRatio="xMidYMid meet">
        <text id="textMain"  x="50%" y="60%" text-anchor="middle"
              font-size="140" class="wire">----</text>
        <text id="textAlt"   x="50%" y="60%" text-anchor="middle"
              font-size="140" class="wire alt">----</text>
        <text id="textInner" x="50%" y="60%" text-anchor="middle"
              font-size="140" class="wire inner">----</text>
      </svg>

      <div class="toggle" id="toggle">‚ü≤</div>
    </div>
  </div>
</div>

<script>
const main   = document.getElementById("textMain");
const alt    = document.getElementById("textAlt");
const inner  = document.getElementById("textInner");
const toggle = document.getElementById("toggle");
const display = document.getElementById("display");

const API_URL = "https://api.coinbase.com/v2/prices/spot?currency=USD";
const TIMEZONE = "America/Denver";

let mode = "price";
let lastPrice = "----";

function setText(val) {
  main.textContent  = val;
  alt.textContent   = val;
  inner.textContent = val;
}

/* ===== PRICE UPDATE (NO COMMA) ===== */
async function updatePrice() {
  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    lastPrice = String(Math.round(Number(data.data.amount)));
    if (mode === "price") setText(lastPrice);
  } catch {
    setText("ERROR");
  }
}

/* ===== TIME UPDATE ===== */
function updateTime() {
  if (mode !== "time") return;

  const time = new Intl.DateTimeFormat("en-US", {
    timeZone: TIMEZONE,
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    hour12: true
  }).format(new Date());

  setText(time);
}

/* ===== TOGGLE ===== */
toggle.addEventListener("click", () => {
  mode = mode === "price" ? "time" : "price";

  if (mode === "price") {
    display.classList.remove("time-mode");
    setText(lastPrice);
  } else {
    display.classList.add("time-mode");
  }
});

/* ===== GLITCH RANDOMIZER (MORE FREQUENT) ===== */
function triggerGlitch() {
  display.classList.add("glitch");
  setTimeout(() => display.classList.remove("glitch"), 140);
  setTimeout(triggerGlitch, 3000 + Math.random() * 3000);
}

updatePrice();
triggerGlitch();

setInterval(updatePrice, 12000);
setInterval(updateTime, 1000);
</script>

</body>
</html>
