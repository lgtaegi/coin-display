<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BTC Core Wire Display</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html, body {
  width: 100%;
  height: 100%;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

/* ===== MACHINE ===== */
.machine {
  position: relative;
  width: min(92vw, 900px);
  aspect-ratio: 1 / 1;
  background: url("machine-bg.png") center / contain no-repeat;
}

/* ===== SCREEN ===== */
.screen {
  position: absolute;
  left: 50%;
  top: 49%;
  transform: translate(-50%, -44%);
  width: 70%;
  height: 22%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

/* ===== ELECTRIC BACKGROUND ===== */
.electric {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background:
    repeating-linear-gradient(
      90deg,
      rgba(0,255,255,0.1) 0px,
      rgba(0,255,255,0.1) 1px,
      transparent 1px,
      transparent 14px
    ),
    repeating-linear-gradient(
      0deg,
      rgba(0,200,255,0.08) 0px,
      rgba(0,200,255,0.08) 1px,
      transparent 1px,
      transparent 20px
    );
  animation: electricMove 18s linear infinite;
  opacity: 0.35;
}

@keyframes electricMove {
  to {
    background-position: 300px 150px, -150px 300px;
  }
}

/* ===== SVG DISPLAY ===== */
.display {
  width: 100%;
  height: 70%;
}

svg {
  width: 100%;
  height: 100%;
}

/* ===== WIRE TEXT ===== */
.wire {
  fill: none;
  stroke: #9ffcff;
  stroke-width: 2.2;
  stroke-linejoin: round;
  stroke-linecap: round;
  filter: drop-shadow(0 0 6px rgba(0,255,255,0.7));
}

/* secondary wire */
.wire.alt {
  stroke: rgba(120,255,255,0.6);
  stroke-width: 1.2;
  stroke-dasharray: 6 4;
}

/* tertiary inner structure */
.wire.inner {
  stroke: rgba(0,200,255,0.5);
  stroke-width: 0.8;
  stroke-dasharray: 2 6;
}

/* ===== TIME MODE ===== */
.time-mode .wire {
  stroke-width: 1.6;
}

/* ===== TOGGLE ===== */
.toggle {
  margin-top: 8px;
  font-size: 1rem;
  color: rgba(180,245,255,0.9);
  cursor: pointer;
  user-select: none;
}
</style>
</head>

<body>

<div class="machine">
  <div class="screen">
    <div class="electric"></div>

    <div class="display" id="display">
      <svg viewBox="0 0 1000 200" preserveAspectRatio="xMidYMid meet">
        <text id="textMain" x="50%" y="60%" text-anchor="middle"
              font-size="140" font-family="monospace"
              class="wire">----</text>

        <text id="textAlt" x="50%" y="60%" text-anchor="middle"
              font-size="140" font-family="monospace"
              class="wire alt">----</text>

        <text id="textInner" x="50%" y="60%" text-anchor="middle"
              font-size="140" font-family="monospace"
              class="wire inner">----</text>
      </svg>
    </div>

    <div class="toggle" id="toggle">‚ü≤</div>
  </div>
</div>

<script>
const main = document.getElementById("textMain");
const alt = document.getElementById("textAlt");
const inner = document.getElementById("textInner");
const toggle = document.getElementById("toggle");
const display = document.getElementById("display");

const API_URL = "https://api.coinbase.com/v2/prices/spot?currency=USD";
const TIMEZONE = "America/Denver";

let mode = "price";
let lastPrice = "----";

function setText(val) {
  main.textContent = val;
  alt.textContent = val;
  inner.textContent = val;
}

async function updatePrice() {
  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    lastPrice = Math.round(Number(data.data.amount)).toLocaleString();
    if (mode === "price") setText(lastPrice);
  } catch {
    setText("ERROR");
  }
}

function updateTime() {
  if (mode !== "time") return;

  const time = new Intl.DateTimeFormat("en-US", {
    timeZone: TIMEZONE,
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    hour12: true
  }).format(new Date());

  setText(time);
}

toggle.addEventListener("click", () => {
  mode = mode === "price" ? "time" : "price";

  if (mode === "price") {
    display.classList.remove("time-mode");
    setText(lastPrice);
  } else {
    display.classList.add("time-mode");
  }
});

updatePrice();
setInterval(updatePrice, 12000);
setInterval(updateTime, 1000);
</script>

</body>
</html>
